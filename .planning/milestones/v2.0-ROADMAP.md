# Milestone v2.0: Cloud Sync

**Status:** SHIPPED 2026-01-14
**Phases:** 7-11
**Total Plans:** 8

## Overview

Backend for multi-computer access with advanced capture improvements. Migrated from local SQLite to hosted Neon Postgres database, enabling sync across machines.

## Phases

### Phase 7: Backend Setup

**Goal**: Set up hosted API server and database for multi-computer access
**Depends on**: v1.0 complete
**Plans**: 2 plans

Plans:
- [x] 07-01: API package setup with Hono and Neon database connection
- [x] 07-02: API routes for items and sessions CRUD

**Details:**
- Created @mental/api package with Hono framework
- Dual-schema pattern: SQLite for local MCP, Postgres for hosted API
- Full REST API with items CRUD and sessions management
- Type-safe Hono RPC client for downstream consumers

### Phase 8: Data Sync

**Goal**: Migrate from local SQLite to hosted database with sync capability
**Depends on**: Phase 7
**Plans**: 2 plans

Plans:
- [x] 08-01: Neon database setup and schema push
- [x] 08-02: Migration script and data verification

**Details:**
- Neon Postgres database with mental_items table
- drizzle-kit configured for schema management
- Migration script preserving original IDs
- Handled mixed timestamp formats in migration

### Phase 9: MCP Server Sync

**Goal**: Update MCP server to use remote API instead of local SQLite
**Depends on**: Phase 8
**Plans**: 1 plan

Plans:
- [x] 09-01: Convert MCP tools to remote API calls

**Details:**
- All 8 MCP tools converted to remote API calls
- Theme extraction remains local (preprocessing)
- Removed database dependencies from MCP server

### Phase 10: Webapp Sync

**Goal**: Update webapp to use remote API instead of local database
**Depends on**: Phase 8
**Plans**: 1 plan

Plans:
- [x] 10-01: Convert webapp to remote API calls

**Details:**
- Dashboard and detail pages fetch via Hono RPC client
- POST/PUT routes proxy to remote API
- Removed @mental/db dependency from webapp

### Phase 11: Advanced Capture

**Goal**: Sentiment/urgency detection, project context, auto-tagging
**Depends on**: Phase 10
**Plans**: 2 plans

Plans:
- [x] 11-01: Enhanced theme extraction with sentiment detection
- [x] 11-02: Project context and auto-tagging

**Details:**
- Sentiment detection: blocker, concern, question, idea
- Auto-tags based on sentiment (e.g., blocker â†’ [blocker, urgent])
- Project field for context association
- Priority order: blocker > concern > question > idea

---

## Milestone Summary

**Key Decisions:**
- Dual schema pattern: SQLite (local) + Postgres (hosted)
- Hono RPC client for type-safe API calls
- Sentiment detection via string pattern matching (to be replaced with LLM-driven in v3.0)
- In-memory session storage (personal tool, single instance)

**Issues Resolved:**
- drizzle-orm version conflicts between packages
- drizzle-kit v0.20 config format compatibility
- Mixed timestamp format detection in migration
- TypeScript type inference with Hono app.route()

**Issues Deferred:**
- LLM-driven theme selection (captured for v3.0)

**Technical Debt Incurred:**
- String-based sentiment detection (works but not ideal)
- API dev script requires manual .env.local loading (fixed in v2.0)

---

_For current project status, see .planning/ROADMAP.md_
