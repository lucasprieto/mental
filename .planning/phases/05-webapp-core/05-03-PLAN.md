---
phase: 05-webapp-core
plan: 03
type: execute
depends_on: ["05-02"]
files_modified: [packages/webapp/src/app/item/[id]/page.tsx]
---

<objective>
Create item detail view showing full content and resolution history.

Purpose: Let users see full details of any captured thought.
Output: Item detail page at /item/[id] with full content, status, and actions.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-webapp-core/05-02-SUMMARY.md

**From 05-02:**
- Dashboard with item cards
- Cards link to /item/[id]

**Detail view shows:**
- Full title and content
- Status with visual indicator
- Theme and tags
- Timestamps (created, updated, resolved)
- Resolution summary (if resolved)
- Session info (if linked)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create item detail page</name>
  <files>packages/webapp/src/app/item/[id]/page.tsx</files>
  <action>
Create src/app/item/[id]/page.tsx:

```typescript
import { getDatabase } from "@/lib/db";
import { mentalItems, eq } from "@mental/db";
import Link from "next/link";
import { notFound } from "next/navigation";

export const dynamic = "force-dynamic";

interface PageProps {
  params: Promise<{ id: string }>;
}

export default async function ItemDetail({ params }: PageProps) {
  const { id } = await params;
  const db = getDatabase();

  const items = await db.select()
    .from(mentalItems)
    .where(eq(mentalItems.id, id))
    .limit(1);

  if (items.length === 0) {
    notFound();
  }

  const item = items[0];
  const tags = JSON.parse(item.tags) as string[];

  return (
    <div className="max-w-3xl">
      {/* Back link */}
      <Link
        href="/"
        className="text-blue-600 hover:text-blue-800 text-sm mb-4 inline-block"
      >
        ← Back to Dashboard
      </Link>

      {/* Header */}
      <div className="bg-white rounded-lg shadow p-6 mb-6">
        <div className="flex items-start justify-between mb-4">
          <h1 className="text-2xl font-bold text-gray-900">{item.title}</h1>
          <span className={`px-3 py-1 text-sm rounded-full ${
            item.status === "open"
              ? "bg-blue-100 text-blue-700"
              : "bg-green-100 text-green-700"
          }`}>
            {item.status}
          </span>
        </div>

        {/* Meta info */}
        <div className="flex flex-wrap gap-2 mb-4">
          {item.theme && (
            <span className="px-2 py-1 bg-purple-100 text-purple-700 text-sm rounded">
              Theme: {item.theme}
            </span>
          )}
          {tags.map(tag => (
            <span key={tag} className="px-2 py-1 bg-gray-100 text-gray-600 text-sm rounded">
              {tag}
            </span>
          ))}
        </div>

        {/* Timestamps */}
        <div className="text-sm text-gray-500 space-y-1">
          <p>Created: {item.createdAt.toLocaleString()}</p>
          <p>Updated: {item.updatedAt.toLocaleString()}</p>
          {item.resolvedAt && (
            <p>Resolved: {item.resolvedAt.toLocaleString()}</p>
          )}
          {item.sessionId && (
            <p>Session: {item.sessionId}</p>
          )}
        </div>
      </div>

      {/* Content */}
      <div className="bg-white rounded-lg shadow p-6 mb-6">
        <h2 className="text-lg font-semibold mb-3 text-gray-800">Content</h2>
        <div className="prose prose-gray max-w-none">
          <p className="whitespace-pre-wrap">{item.content}</p>
        </div>
      </div>

      {/* Resolution (if resolved) */}
      {item.status === "resolved" && item.resolution && (
        <div className="bg-green-50 rounded-lg shadow p-6 border border-green-200">
          <h2 className="text-lg font-semibold mb-3 text-green-800">Resolution</h2>
          <p className="text-green-700 whitespace-pre-wrap">{item.resolution}</p>
        </div>
      )}

      {/* ID footer */}
      <p className="text-xs text-gray-400 mt-6">
        ID: {item.id}
      </p>
    </div>
  );
}
```

Create not-found handler at src/app/item/[id]/not-found.tsx:
```typescript
import Link from "next/link";

export default function NotFound() {
  return (
    <div className="text-center py-12">
      <h2 className="text-2xl font-bold text-gray-900 mb-2">Item Not Found</h2>
      <p className="text-gray-600 mb-4">The thought you're looking for doesn't exist.</p>
      <Link href="/" className="text-blue-600 hover:text-blue-800">
        ← Back to Dashboard
      </Link>
    </div>
  );
}
```
  </action>
  <verify>pnpm --filter @mental/webapp build succeeds</verify>
  <done>Item detail page shows full content, status, timestamps, resolution</done>
</task>

<task type="auto">
  <name>Task 2: Verify end-to-end navigation</name>
  <files>packages/webapp/src/app/item/[id]/page.tsx</files>
  <action>
Verify the complete flow:

1. Build and run: pnpm --filter @mental/webapp dev
2. Visit http://localhost:3001
3. Dashboard shows items (if any exist in DB)
4. Click an item card → navigates to /item/[id]
5. Detail page shows full content
6. Back link returns to dashboard
7. Invalid ID shows 404 not found page

If no items exist in database:
- Use MCP Inspector to capture a test item
- Or check that database path is correct
  </action>
  <verify>Full navigation flow works: Dashboard → Item Detail → Back to Dashboard</verify>
  <done>End-to-end navigation verified, Phase 5 complete</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] pnpm --filter @mental/webapp build succeeds
- [ ] /item/[id] shows full item details
- [ ] Not found page works for invalid IDs
- [ ] Back link returns to dashboard
- [ ] Resolution section shows for resolved items
- [ ] Session ID displayed if present
</verification>

<success_criteria>
- Item detail page displays all fields
- Navigation between dashboard and detail works
- 404 handled gracefully
- Phase 5 complete - webapp core functional
</success_criteria>

<output>
After completion, create `.planning/phases/05-webapp-core/05-03-SUMMARY.md`
</output>
