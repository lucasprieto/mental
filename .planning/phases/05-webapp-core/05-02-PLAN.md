---
phase: 05-webapp-core
plan: 02
type: execute
depends_on: ["05-01"]
files_modified: [packages/webapp/src/app/page.tsx, packages/webapp/src/components/ItemCard.tsx, packages/webapp/src/components/ItemList.tsx]
---

<objective>
Build the dashboard view showing open items and recently resolved.

Purpose: Give users at-a-glance view of their mental state - what's open, what's done.
Output: Dashboard with open items list, recently resolved section, theme/tag overview.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-webapp-core/05-01-SUMMARY.md

**From 05-01:**
- Next.js app at packages/webapp
- Database connection via src/lib/db.ts
- Tailwind CSS configured

**Dashboard requirements (from PROJECT.md):**
- Open items (primary focus)
- Recently resolved
- Themes/tags at a glance

**Schema fields to display:**
- title, content (truncated), status
- theme, tags (parsed from JSON)
- createdAt, resolvedAt
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ItemCard component</name>
  <files>packages/webapp/src/components/ItemCard.tsx</files>
  <action>
Create src/components/ItemCard.tsx:

```typescript
import type { MentalItemRow } from "@mental/db";
import Link from "next/link";

interface ItemCardProps {
  item: MentalItemRow;
}

export function ItemCard({ item }: ItemCardProps) {
  const tags = JSON.parse(item.tags) as string[];

  return (
    <Link
      href={`/item/${item.id}`}
      className="block bg-white rounded-lg shadow hover:shadow-md transition-shadow p-4"
    >
      <div className="flex items-start justify-between mb-2">
        <h3 className="font-medium text-gray-900 truncate flex-1">
          {item.title}
        </h3>
        <span className={`ml-2 px-2 py-0.5 text-xs rounded-full ${
          item.status === "open"
            ? "bg-blue-100 text-blue-700"
            : "bg-green-100 text-green-700"
        }`}>
          {item.status}
        </span>
      </div>

      <p className="text-gray-600 text-sm line-clamp-2 mb-3">
        {item.content}
      </p>

      <div className="flex items-center gap-2 flex-wrap">
        {item.theme && (
          <span className="px-2 py-0.5 bg-purple-100 text-purple-700 text-xs rounded">
            {item.theme}
          </span>
        )}
        {tags.map(tag => (
          <span key={tag} className="px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded">
            {tag}
          </span>
        ))}
      </div>

      <p className="text-gray-400 text-xs mt-2">
        {item.status === "resolved" && item.resolvedAt
          ? `Resolved ${item.resolvedAt.toLocaleDateString()}`
          : `Created ${item.createdAt.toLocaleDateString()}`
        }
      </p>
    </Link>
  );
}
```

Note: Uses line-clamp-2 for content truncation (Tailwind built-in).
  </action>
  <verify>pnpm --filter @mental/webapp build succeeds</verify>
  <done>ItemCard component renders item with status, theme, tags</done>
</task>

<task type="auto">
  <name>Task 2: Create ItemList component</name>
  <files>packages/webapp/src/components/ItemList.tsx</files>
  <action>
Create src/components/ItemList.tsx:

```typescript
import type { MentalItemRow } from "@mental/db";
import { ItemCard } from "./ItemCard";

interface ItemListProps {
  title: string;
  items: MentalItemRow[];
  emptyMessage?: string;
}

export function ItemList({ title, items, emptyMessage = "No items" }: ItemListProps) {
  return (
    <section className="mb-8">
      <h3 className="text-lg font-semibold mb-4 text-gray-800">
        {title}
        <span className="ml-2 text-sm font-normal text-gray-500">
          ({items.length})
        </span>
      </h3>

      {items.length === 0 ? (
        <p className="text-gray-500 italic">{emptyMessage}</p>
      ) : (
        <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
          {items.map(item => (
            <ItemCard key={item.id} item={item} />
          ))}
        </div>
      )}
    </section>
  );
}
```
  </action>
  <verify>pnpm --filter @mental/webapp build succeeds</verify>
  <done>ItemList component renders grid of items with title and count</done>
</task>

<task type="auto">
  <name>Task 3: Build full dashboard page</name>
  <files>packages/webapp/src/app/page.tsx</files>
  <action>
Update src/app/page.tsx with full dashboard:

```typescript
import { getDatabase } from "@/lib/db";
import { mentalItems, desc, eq } from "@mental/db";
import { ItemList } from "@/components/ItemList";

export const dynamic = "force-dynamic";

export default async function Dashboard() {
  const db = getDatabase();

  // Fetch open items (most recent first)
  const openItems = await db.select()
    .from(mentalItems)
    .where(eq(mentalItems.status, "open"))
    .orderBy(desc(mentalItems.createdAt));

  // Fetch recently resolved (last 10)
  const resolvedItems = await db.select()
    .from(mentalItems)
    .where(eq(mentalItems.status, "resolved"))
    .orderBy(desc(mentalItems.resolvedAt))
    .limit(10);

  // Get unique themes from open items
  const themes = [...new Set(openItems.map(i => i.theme).filter(Boolean))];

  // Get all tags from open items
  const allTags = openItems.flatMap(i => JSON.parse(i.tags) as string[]);
  const tagCounts = allTags.reduce((acc, tag) => {
    acc[tag] = (acc[tag] || 0) + 1;
    return acc;
  }, {} as Record<string, number>);
  const topTags = Object.entries(tagCounts)
    .sort((a, b) => b[1] - a[1])
    .slice(0, 10);

  return (
    <div>
      {/* Stats row */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
        <div className="bg-white p-4 rounded-lg shadow">
          <p className="text-3xl font-bold text-blue-600">{openItems.length}</p>
          <p className="text-gray-600">Open</p>
        </div>
        <div className="bg-white p-4 rounded-lg shadow">
          <p className="text-3xl font-bold text-green-600">{resolvedItems.length}</p>
          <p className="text-gray-600">Recently Resolved</p>
        </div>
        <div className="bg-white p-4 rounded-lg shadow">
          <p className="text-3xl font-bold text-purple-600">{themes.length}</p>
          <p className="text-gray-600">Active Themes</p>
        </div>
        <div className="bg-white p-4 rounded-lg shadow">
          <p className="text-3xl font-bold text-gray-600">{topTags.length}</p>
          <p className="text-gray-600">Tags in Use</p>
        </div>
      </div>

      {/* Themes & Tags overview */}
      {(themes.length > 0 || topTags.length > 0) && (
        <div className="bg-white rounded-lg shadow p-4 mb-8">
          <h3 className="font-semibold mb-3">At a Glance</h3>
          <div className="flex flex-wrap gap-2">
            {themes.map(theme => (
              <span key={theme} className="px-3 py-1 bg-purple-100 text-purple-700 text-sm rounded-full">
                {theme}
              </span>
            ))}
            {topTags.map(([tag, count]) => (
              <span key={tag} className="px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-full">
                {tag} ({count})
              </span>
            ))}
          </div>
        </div>
      )}

      {/* Open items */}
      <ItemList
        title="Open Items"
        items={openItems}
        emptyMessage="No open items. Capture some thoughts via Claude Code!"
      />

      {/* Recently resolved */}
      <ItemList
        title="Recently Resolved"
        items={resolvedItems}
        emptyMessage="No resolved items yet."
      />
    </div>
  );
}
```
  </action>
  <verify>pnpm --filter @mental/webapp dev; visit localhost:3001 shows dashboard with open and resolved sections</verify>
  <done>Dashboard shows open items, recently resolved, themes/tags overview</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] pnpm --filter @mental/webapp build succeeds
- [ ] Dashboard shows stats (open, resolved, themes, tags)
- [ ] Open items displayed in grid with status badges
- [ ] Recently resolved section shows last 10
- [ ] Themes and tags displayed at a glance
- [ ] Cards link to /item/[id] (will 404 until 05-03)
</verification>

<success_criteria>
- Dashboard displays open items prominently
- Recently resolved items visible (last 10)
- Themes and tags shown at a glance
- Items are clickable (linking to detail view)
- Responsive grid layout
</success_criteria>

<output>
After completion, create `.planning/phases/05-webapp-core/05-02-SUMMARY.md`
</output>
