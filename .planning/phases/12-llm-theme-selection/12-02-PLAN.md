# Plan 12-02: Remove Tags from Schema, API, and Webapp

## Overview

Remove the `tags` field from the entire system:
- Database schema (keep column for backwards compat, stop using it)
- API routes (remove from requests/responses)
- Shared types
- Webapp (remove filter, display, editing)

## Files to Modify

| Package | File | Changes |
|---------|------|---------|
| shared | `src/types.ts` | Remove tags from MentalItem and CreateItemInput |
| api | `src/routes/items.ts` | Remove tags from query params, create, update |
| webapp | `src/types/item.ts` | Remove tags field |
| webapp | `src/app/page.tsx` | Remove tag filtering logic |
| webapp | `src/components/FilterBar.tsx` | Remove tag filter UI |
| webapp | `src/components/ItemCard.tsx` | Remove tag display |
| webapp | `src/components/ItemDetailClient.tsx` | Remove tag display |
| webapp | `src/components/EditItemForm.tsx` | Remove tag editing |
| webapp | `src/components/CaptureModal.tsx` | Remove tag input |
| webapp | `src/app/api/items/route.ts` | Remove tags from POST |
| webapp | `src/app/api/items/[id]/route.ts` | Remove tags from PUT |

**Note:** Keep `tags` column in database schemas (`packages/db/src/schema.ts` and `schema-pg.ts`) for backwards compatibility with existing data. Just stop reading/writing it.

## Tasks

### Task 1: Update shared types

**File:** `packages/shared/src/types.ts`

Remove tags from interfaces:

```typescript
export interface MentalItem {
  id: string;
  title: string;
  content: string;
  status: "open" | "resolved";
  theme: string | null;
  // tags: string[];  -- REMOVE
  project: string | null;
  sessionId: string | null;
  createdAt: string;
  updatedAt: string;
  resolvedAt: string | null;
  resolution: string | null;
}

export interface CreateItemInput {
  title: string;
  content: string;
  // tags?: string[];  -- REMOVE
  theme?: string;
  project?: string;
  sessionId?: string;
}
```

### Task 2: Update API routes

**File:** `packages/api/src/routes/items.ts`

Remove tags from:
- GET query params (line 16)
- GET filtering logic (lines 36-42)
- POST body schema (line 73)
- POST insert (line 88)
- PUT body schema (line 112)
- PUT updates (line 141)

### Task 3: Update webapp types

**File:** `packages/webapp/src/types/item.ts`

Remove tags field from Item interface.

### Task 4: Update webapp page

**File:** `packages/webapp/src/app/page.tsx`

Remove:
- `tags` from searchParams type
- `tagsFilter` parsing
- `allTags` / `uniqueTags` computation
- Tags filtering logic
- `tags` and `activeTags` props to FilterBar

### Task 5: Update FilterBar component

**File:** `packages/webapp/src/components/FilterBar.tsx`

Remove:
- `tags` and `activeTags` from props interface
- `toggleTag` function
- `updateFilters` tags handling
- Tags filter UI section

### Task 6: Update ItemCard component

**File:** `packages/webapp/src/components/ItemCard.tsx`

Remove tags parsing and display.

### Task 7: Update ItemDetailClient component

**File:** `packages/webapp/src/components/ItemDetailClient.tsx`

Remove tags parsing and display.

### Task 8: Update EditItemForm component

**File:** `packages/webapp/src/components/EditItemForm.tsx`

Remove:
- `tags` state
- Tags input field
- Tags in save payload

### Task 9: Update CaptureModal component

**File:** `packages/webapp/src/components/CaptureModal.tsx`

Remove:
- `tags` state
- Tags input field
- Tags in save payload

### Task 10: Update webapp API routes

**File:** `packages/webapp/src/app/api/items/route.ts`

Remove tags from POST body handling.

**File:** `packages/webapp/src/app/api/items/[id]/route.ts`

Remove tags from PUT body handling.

## Verification

1. Start API: `cd packages/api && pnpm dev`
2. Start webapp: `cd packages/webapp && pnpm dev`
3. Verify dashboard loads without errors
4. Verify no tag filter appears
5. Verify item cards don't show tags
6. Verify item detail page doesn't show tags
7. Verify capture modal has no tag input
8. Verify edit form has no tag input
9. Create a new item - should work without tags
10. Edit an existing item - should work without tags

## Rollback

Revert all file changes. Existing data with tags is preserved in database.
