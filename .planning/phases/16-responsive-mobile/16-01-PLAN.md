---
phase: 16-responsive-mobile
plan: 01
type: execute
depends_on: ["15-02"]
files_modified: [packages/webapp/src/components/Sidebar.tsx, packages/webapp/src/app/layout.tsx, packages/webapp/src/components/ItemDetailClient.tsx]
---

<objective>
Add responsive mobile layout with collapsible sidebar.

Purpose: Make webapp usable on phone screens with hamburger menu for sidebar.
Output: Sidebar hidden on mobile with hamburger toggle, responsive layout adjustments.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
@./.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Key source files:**
@packages/webapp/src/components/Sidebar.tsx
@packages/webapp/src/app/layout.tsx
@packages/webapp/src/components/ItemDetailClient.tsx

**Current State:**
- Sidebar: Fixed `w-64` always visible, no mobile handling
- Layout: Fixed `ml-64` margin, no responsive handling
- Grids: Already responsive (`md:grid-cols-2 lg:grid-cols-3`)

**Tailwind Breakpoints:**
- `sm:` = 640px+
- `md:` = 768px+ (tablet)
- `lg:` = 1024px+ (desktop)

**Pattern: Mobile-first responsive sidebar**
- Mobile: Sidebar hidden, hamburger button in header
- Desktop (md+): Sidebar always visible, no hamburger
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update layout with responsive margin and mobile header</name>
  <files>packages/webapp/src/app/layout.tsx</files>
  <action>
1. Update layout.tsx to:
   - Remove fixed `ml-64` margin
   - Add responsive margin: `md:ml-64` (no margin on mobile, 64 on desktop)
   - Add a mobile header with hamburger button (visible only on mobile)
   - Pass sidebar open state via context or keep sidebar self-contained

**Pattern:**
```tsx
// layout.tsx
<body className="min-h-screen bg-gray-50">
  <main className="md:ml-64">
    <div className="px-4 py-4 md:px-6 md:py-8">
      {children}
    </div>
  </main>
</body>
```

Note: The hamburger button and sidebar state will be managed in the Sidebar component itself.
  </action>
  <verify>Page renders without sidebar overlap on desktop</verify>
  <done>Layout has responsive margin.</done>
</task>

<task type="auto">
  <name>Task 2: Make Sidebar responsive with hamburger menu</name>
  <files>packages/webapp/src/components/Sidebar.tsx</files>
  <action>
1. Add state for mobile menu open/closed
2. Add hamburger button that's only visible on mobile (`md:hidden`)
3. Make sidebar:
   - Hidden on mobile by default (translate off-screen or hidden)
   - Slides in when hamburger clicked
   - Always visible on desktop (`md:translate-x-0` or `md:block`)
4. Add overlay when sidebar is open on mobile
5. Close sidebar when clicking overlay or a filter

**Pattern:**
```tsx
"use client";
import { useState } from "react";

export function Sidebar({ themes, activeStatus, activeTheme }: SidebarProps) {
  const [isOpen, setIsOpen] = useState(false);

  // ... existing code ...

  return (
    <>
      {/* Mobile hamburger button - fixed position */}
      <button
        onClick={() => setIsOpen(true)}
        className="fixed top-4 left-4 z-50 p-2 bg-white rounded-lg shadow md:hidden"
        aria-label="Open menu"
      >
        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>

      {/* Overlay for mobile */}
      {isOpen && (
        <div
          className="fixed inset-0 bg-black/50 z-40 md:hidden"
          onClick={() => setIsOpen(false)}
        />
      )}

      {/* Sidebar */}
      <aside className={`
        fixed top-0 left-0 w-64 h-screen overflow-y-auto border-r border-gray-200 bg-white z-40
        transform transition-transform duration-200 ease-in-out
        ${isOpen ? "translate-x-0" : "-translate-x-full"}
        md:translate-x-0
      `}>
        {/* Close button for mobile */}
        <div className="flex items-center justify-between p-4 border-b border-gray-100">
          <h1 className="text-lg font-semibold">Mental</h1>
          <button
            onClick={() => setIsOpen(false)}
            className="p-1 text-gray-500 hover:text-gray-700 md:hidden"
            aria-label="Close menu"
          >
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>

        {/* ... rest of sidebar content ... */}
      </aside>
    </>
  );
}
```

2. Update filter click handlers to close sidebar on mobile:
```tsx
const updateFilter = useCallback(
  (key: "status" | "theme", value: string | null) => {
    // ... existing code ...
    setIsOpen(false); // Close on mobile after selection
  },
  [router, searchParams]
);
```
  </action>
  <verify>
1. On mobile viewport: hamburger visible, sidebar hidden
2. Click hamburger: sidebar slides in with overlay
3. Click filter: sidebar closes, filter applied
4. Click overlay: sidebar closes
5. On desktop: sidebar always visible, no hamburger
  </verify>
  <done>Sidebar is responsive with hamburger menu on mobile.</done>
</task>

<task type="auto">
  <name>Task 3: Adjust item detail header for mobile</name>
  <files>packages/webapp/src/components/ItemDetailClient.tsx</files>
  <action>
1. Update the header flex layout to wrap better on mobile:
   - Change `flex items-start justify-between` to stack on mobile
   - Title on top, status/edit buttons below

**Current:**
```tsx
<div className="flex items-start justify-between mb-4">
```

**Updated:**
```tsx
<div className="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-4">
```

2. Ensure buttons have good tap targets (min 44px)
  </action>
  <verify>Item detail page looks good on mobile viewport</verify>
  <done>Item detail header is responsive.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Responsive mobile layout with hamburger sidebar</what-built>
  <how-to-verify>
    1. Open http://localhost:3001 on mobile or resize browser to mobile width
    2. Verify hamburger button appears (three lines icon)
    3. Click hamburger - sidebar should slide in from left
    4. Click a filter - sidebar should close and filter apply
    5. Click overlay (dark background) - sidebar should close
    6. Resize to desktop - sidebar should always be visible, no hamburger
    7. Navigate to item detail - verify header looks good on mobile
  </how-to-verify>
  <resume-signal>Type "approved" to complete phase and v3.0 milestone</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Layout has responsive margin (none on mobile, ml-64 on desktop)
- [ ] Hamburger button visible on mobile only
- [ ] Sidebar hidden on mobile by default
- [ ] Sidebar slides in when hamburger clicked
- [ ] Overlay appears behind sidebar on mobile
- [ ] Clicking filter closes sidebar on mobile
- [ ] Sidebar always visible on desktop
- [ ] Item detail header wraps nicely on mobile
- [ ] Human verification approved
</verification>

<success_criteria>
- Webapp fully usable on mobile phones
- Sidebar accessible via hamburger menu
- No horizontal scrolling on mobile
- Touch-friendly tap targets
- Smooth sidebar slide animation
- Phase 16 and v3.0 milestone complete
</success_criteria>

<output>
After completion, create `.planning/phases/16-responsive-mobile/16-01-SUMMARY.md`
</output>
